import{r as u,u as f,j as e,H as z,a as I}from"./app-CKvo3YMG.js";import{A as L}from"./AuthenticatedLayout-CttmCh-1.js";import{A as j}from"./index-BmD7pytL.js";import{m as y}from"./proxy-C3rojBCA.js";import"./transition-Bv1B2sSu.js";function T({auth:$,event:a,stats:c}){const[v,p]=u.useState(!1),[N,x]=u.useState(!1),{data:r,setData:l,post:w,processing:h,reset:A,errors:o}=f({group_name:"",total_passes:1,contact_phone:"",members:[{name:""}]}),{data:n,setData:m,put:k,processing:b}=f({settings:{whatsapp_template:a.settings?.whatsapp_template||"¡Hola {nombre}! Nos encantaría que nos acompañes en nuestro gran día. Aquí tienes tu invitación personalizada: {link}"}}),C=()=>{l("members",[...r.members,{name:""}])},_=t=>{const s=r.members.filter((d,i)=>i!==t);l("members",s)},E=t=>{t.preventDefault(),w(route("guests.store",a.id),{onSuccess:()=>{p(!1),A()}})},M=t=>{t.preventDefault(),k(route("events.update",a.id),{onSuccess:()=>x(!1)})},G=t=>{confirm("¿Estás seguro de eliminar este invitado?")&&I.delete(route("guests.destroy",[a.id,t]))},g=t=>`${window.location.origin}/${a.slug}?g=${t}`,P=t=>{const s=g(t);navigator.clipboard.writeText(s),alert("Enlace copiado al portapapeles")},W=t=>{if(!t.contact_phone){alert("Este invitado no tiene un número de teléfono registrado.");return}const s=g(t.slug);let d=n.settings.whatsapp_template.replace("{nombre}",t.group_name).replace("{link}",s);const i=encodeURIComponent(d),S=t.contact_phone.replace(/\D/g,"");window.open(`https://wa.me/${S}?text=${i}`,"_blank")};return e.jsxs(L,{header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-[#1A1A1A] font-serif",children:["Lista de Invitados: ",a.name]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>x(!0),className:"border border-[#C5A059] text-[#C5A059] px-6 py-2 font-sans uppercase tracking-widest text-[10px] hover:bg-[#C5A059] hover:text-white transition-all",children:"Configurar WhatsApp"}),e.jsx("button",{onClick:()=>p(!0),className:"bg-[#C5A059] text-white px-6 py-2 font-sans uppercase tracking-widest text-[10px] hover:bg-[#1A1A1A] transition-all",children:"+ Nuevo Grupo"})]})]}),children:[e.jsx(z,{title:"Gestión de Invitados"}),e.jsx("div",{className:"py-12 bg-[#F9F9F7]",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-8",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[{label:"Grupos",value:c.total_groups},{label:"Invitados Totales",value:c.total_guests},{label:"Confirmados",value:c.confirmed_guests,color:"text-green-600"},{label:"Pendientes",value:c.pending_guests,color:"text-amber-600"}].map((t,s)=>e.jsxs("div",{className:"bg-white p-6 border border-[#E0E0E0] shadow-sm",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-widest text-gray-400 mb-2 font-bold",children:t.label}),e.jsx("p",{className:`text-3xl font-serif ${t.color||"text-[#1A1A1A]"}`,children:t.value})]},s))}),e.jsx("div",{className:"bg-white border border-[#E0E0E0] shadow-sm overflow-hidden",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 border-b border-[#E0E0E0]",children:[e.jsx("th",{className:"px-6 py-4 text-[10px] uppercase tracking-widest text-gray-400 font-bold",children:"Grupo / Familia"}),e.jsx("th",{className:"px-6 py-4 text-[10px] uppercase tracking-widest text-gray-400 font-bold",children:"Pases"}),e.jsx("th",{className:"px-6 py-4 text-[10px] uppercase tracking-widest text-gray-400 font-bold",children:"Estado"}),e.jsx("th",{className:"px-6 py-4 text-[10px] uppercase tracking-widest text-gray-400 font-bold",children:"Link Personalizado"}),e.jsx("th",{className:"px-6 py-4 text-[10px] uppercase tracking-widest text-gray-400 font-bold text-right",children:"Acciones"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[a.guest_groups.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-serif text-lg text-[#1A1A1A]",children:t.group_name}),e.jsxs("div",{className:"text-[10px] text-gray-400 font-sans uppercase tracking-widest",children:[t.members?.length||0," integrantes · ",t.contact_phone||"Sin teléfono"]})]}),e.jsx("td",{className:"px-6 py-4 font-sans text-sm",children:t.total_passes}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`text-[9px] uppercase tracking-widest px-2 py-1 font-bold ${t.status==="confirmed"?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700"}`,children:t.status==="confirmed"?"Confirmado":"Pendiente"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-100 px-3 py-1 rounded text-[10px] text-gray-500 font-mono truncate max-w-[150px]",children:[a.slug,"?g=",t.slug]}),e.jsx("button",{onClick:()=>P(t.slug),className:"text-[#C5A059] hover:text-[#1A1A1A] transition-colors p-1",title:"Copiar Enlace",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})})}),e.jsx("button",{onClick:()=>W(t),className:"text-green-500 hover:text-green-700 transition-colors p-1",title:"Enviar por WhatsApp",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})})})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>G(t.id),className:"text-[10px] uppercase tracking-widest text-red-300 hover:text-red-600 font-bold transition-colors",children:"Eliminar"})})]},t.id)),a.guest_groups.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-20 text-center italic text-gray-400 font-serif",children:"Aún no hay invitados registrados."})})]})]})})]})}),e.jsx(j,{children:v&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-6 bg-black/60 backdrop-blur-sm",children:e.jsxs(y.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white w-full max-w-2xl p-8 md:p-12 shadow-2xl relative max-h-[90vh] overflow-y-auto",children:[e.jsx("button",{onClick:()=>p(!1),className:"absolute top-8 right-8 text-2xl text-gray-400 hover:text-black",children:"×"}),e.jsx("h3",{className:"text-3xl font-serif mb-8 border-b border-gray-100 pb-4 text-[#1A1A1A]",children:"Nuevo Grupo de Invitados"}),e.jsxs("form",{onSubmit:E,className:"space-y-8",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase tracking-widest text-[#888888] mb-2 font-bold",children:"Nombre del Grupo / Familia"}),e.jsx("input",{type:"text",value:r.group_name,onChange:t=>l("group_name",t.target.value),className:"w-full border-0 border-b border-gray-200 focus:border-[#C5A059] focus:ring-0 font-serif text-xl p-0 py-2 bg-transparent",placeholder:"Ej: Familia Castillo",required:!0}),o.group_name&&e.jsx("div",{className:"text-red-500 text-[10px] mt-1 uppercase",children:o.group_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase tracking-widest text-[#888888] mb-2 font-bold",children:"Pases de Cortesía"}),e.jsx("input",{type:"number",min:"1",value:r.total_passes,onChange:t=>l("total_passes",t.target.value),className:"w-full border-0 border-b border-gray-200 focus:border-[#C5A059] focus:ring-0 font-sans text-xl p-0 py-2 bg-transparent"}),o.total_passes&&e.jsx("div",{className:"text-red-500 text-[10px] mt-1 uppercase",children:o.total_passes})]})]}),e.jsx("div",{className:"grid md:grid-cols-1 gap-8",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase tracking-widest text-[#888888] mb-2 font-bold",children:"Teléfono de Contacto (Preferiblemente con WhatsApp)"}),e.jsx("input",{type:"text",value:r.contact_phone,onChange:t=>l("contact_phone",t.target.value),className:"w-full border-0 border-b border-gray-200 focus:border-[#C5A059] focus:ring-0 font-sans text-xl p-0 py-2 bg-transparent",placeholder:"Ej: +506 8888 8888"}),o.contact_phone&&e.jsx("div",{className:"text-red-500 text-[10px] mt-1 uppercase",children:o.contact_phone})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center border-b border-gray-50 pb-2",children:[e.jsx("label",{className:"text-[10px] uppercase tracking-widest text-[#888888] font-bold",children:"Integrantes Individuales"}),e.jsx("button",{type:"button",onClick:C,className:"text-[#C5A059] text-[10px] font-bold uppercase tracking-widest hover:text-[#1A1A1A] transition-colors",children:"+ Añadir Integrante"})]}),e.jsx("div",{className:"grid gap-4 max-h-60 overflow-y-auto pr-2",children:r.members.map((t,s)=>e.jsxs("div",{className:"flex gap-4 items-center group",children:[e.jsx("input",{type:"text",placeholder:`Nombre del invitado ${s+1}`,value:t.name,onChange:d=>{const i=[...r.members];i[s].name=d.target.value,l("members",i)},className:"flex-1 border-0 border-b border-gray-100 focus:border-[#C5A059] focus:ring-0 text-sm p-0 py-2 bg-transparent",required:!0}),r.members.length>1&&e.jsx("button",{type:"button",onClick:()=>_(s),className:"text-red-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:"×"})]},s))})]}),e.jsx("div",{className:"flex justify-end pt-8",children:e.jsx("button",{type:"submit",disabled:h,className:"bg-[#1A1A1A] text-white px-12 py-4 font-sans uppercase tracking-[0.2em] text-[10px] hover:bg-[#C5A059] transition-all disabled:opacity-50 shadow-xl",children:h?"Guardando...":"Registrar Invitado"})})]})]})})}),e.jsx(j,{children:N&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-6 bg-black/60 backdrop-blur-sm",children:e.jsxs(y.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white w-full max-w-2xl p-8 md:p-12 shadow-2xl relative",children:[e.jsx("button",{onClick:()=>x(!1),className:"absolute top-8 right-8 text-2xl text-gray-400 hover:text-black",children:"×"}),e.jsx("h3",{className:"text-3xl font-serif mb-4 border-b border-gray-100 pb-4 text-[#1A1A1A]",children:"Personalizar Mensaje de WhatsApp"}),e.jsx("p",{className:"text-xs text-gray-500 mb-8 uppercase tracking-widest",children:"Utiliza las etiquetas para personalizar el mensaje."}),e.jsxs("form",{onSubmit:M,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase tracking-widest text-[#888888] mb-4 font-bold",children:"Mensaje Predeterminado"}),e.jsx("textarea",{value:n.settings.whatsapp_template,onChange:t=>m("settings",{...n.settings,whatsapp_template:t.target.value}),className:"w-full border border-gray-100 focus:border-[#C5A059] focus:ring-0 font-sans text-sm p-4 h-40 bg-gray-50 resize-none",placeholder:"Ej: ¡Hola {nombre}!...",required:!0}),e.jsxs("div",{className:"mt-4 flex gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>m("settings",{...n.settings,whatsapp_template:n.settings.whatsapp_template+"{nombre}"}),className:"text-[10px] bg-gray-100 px-3 py-1 rounded hover:bg-gray-200 transition-colors",children:["+ ","{nombre}"]}),e.jsxs("button",{type:"button",onClick:()=>m("settings",{...n.settings,whatsapp_template:n.settings.whatsapp_template+"{link}"}),className:"text-[10px] bg-gray-100 px-3 py-1 rounded hover:bg-gray-200 transition-colors",children:["+ ","{link}"]})]})]}),e.jsx("div",{className:"flex justify-end pt-8",children:e.jsx("button",{type:"submit",disabled:b,className:"bg-[#1A1A1A] text-white px-12 py-4 font-sans uppercase tracking-[0.2em] text-[10px] hover:bg-[#C5A059] transition-all disabled:opacity-50 shadow-xl",children:b?"Guardando...":"Guardar Template"})})]})]})})})]})}export{T as default};
