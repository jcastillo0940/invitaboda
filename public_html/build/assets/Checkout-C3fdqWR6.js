import{r as t,j as e,H as I,b as P}from"./app-CKvo3YMG.js";import{A as E}from"./AuthenticatedLayout-CttmCh-1.js";import{L as _,C as D}from"./loader-circle-CyvKf0Ci.js";import{c as j}from"./createLucideIcon-BHz3UtlU.js";import{C as b}from"./credit-card-BsqyMbBz.js";import"./transition-Bv1B2sSu.js";const M=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],f=j("banknote",M);const $=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],F=j("smartphone",$);function V({auth:L,plan:N,amount:l,orderNumber:n,tilopayConfig:U,user:i}){const[m,h]=t.useState(!0),[o,g]=t.useState(null),[a,c]=t.useState("card"),[d,v]=t.useState(""),[p,w]=t.useState(""),[y,k]=t.useState("1"),[r,C]=t.useState(null);t.useRef(null),t.useEffect(()=>{const s=async()=>{try{const x=await P.post(route("tilopay.token"),{amount:l,currency:"USD",orderNumber:n}),{token:S}=x.data;if(typeof Tilopay<"u"){const T=await Tilopay.Init({token:S,currency:"USD",language:"es",amount:l.toFixed(2),billToEmail:i.email,orderNumber:n,billToFirstName:i.name.split(" ")[0],billToLastName:i.name.split(" ")[1]||"Usuario",billToAddress:"San Jose, Costa Rica",capture:1,redirect:route("payment.callback"),subscription:0});console.log("Tilopay initialized",T),h(!1)}else g("El SDK de Tilopay no se cargó correctamente.")}catch(x){console.error("Error initializing Tilopay:",x),g("Error al conectar con la pasarela de pagos."),h(!1)}},u=setInterval(()=>{typeof Tilopay<"u"&&(clearInterval(u),s())},500);return()=>clearInterval(u)},[]);const A=async()=>{if(a==="yappy"){if(!d){alert("Por favor ingrese su número de Yappy");return}Tilopay.updateOptions({phoneYappy:d})}if(a==="sinpe"){if(!p){alert("Por favor ingrese su DNI para SINPE");return}try{Tilopay.updateOptions({typeDni:y,dni:p});const s=await Tilopay.getSinpeMovil();C(s);return}catch(s){console.error("SINPE Error:",s),alert("Error al generar datos de SINPE");return}}Tilopay.startPayment()};return e.jsxs(E,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-[#1A1A1A] font-serif uppercase tracking-widest",children:"Finalizar Compra"}),children:[e.jsx(I,{title:"Checkout - Tilopay"}),e.jsx("div",{className:"py-12 bg-[#FAF9F6] min-h-screen",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-6 grid lg:grid-cols-5 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white p-8 border border-gray-100 shadow-sm rounded-2xl",children:[e.jsx("h3",{className:"text-[10px] uppercase tracking-[0.3em] text-[#C5A059] font-bold mb-6",children:"Tu Pedido"}),e.jsxs("div",{className:"flex justify-between items-end mb-4 pb-4 border-b border-gray-50",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-serif text-lg text-[#1A1A1A] capitalize",children:["Plan ",N]}),e.jsx("p",{className:"text-[10px] text-gray-400 uppercase tracking-widest",children:"Pago único / Mes"})]}),e.jsxs("span",{className:"font-sans text-xl font-bold",children:["$",l]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-gray-400",children:"Orden"}),e.jsx("span",{className:"font-mono text-gray-600",children:n})]}),e.jsxs("div",{className:"flex justify-between text-lg pt-4 border-t border-gray-50 font-bold text-[#1A1A1A]",children:[e.jsx("span",{className:"font-serif italic font-normal",children:"Total"}),e.jsxs("span",{children:["$",l," USD"]})]})]})]}),e.jsxs("div",{className:"bg-[#1A1A1A] p-8 rounded-2xl text-white",children:[e.jsx("h4",{className:"text-[10px] uppercase tracking-[0.3em] text-[#C5A059] font-bold mb-4",children:"Preguntas Frecuentes"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-[11px] leading-relaxed text-gray-400",children:[e.jsx("span",{className:"text-white block font-bold mb-1",children:"¿Cuándo se activa mi plan?"}),"Instantáneamente después de confirmar el pago."]}),e.jsxs("p",{className:"text-[11px] leading-relaxed text-gray-400",children:[e.jsx("span",{className:"text-white block font-bold mb-1",children:"¿Es seguro?"}),"Usamos Tilopay con protocolos de seguridad bancaria y 3DS."]})]})]})]}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"bg-white border border-gray-100 shadow-xl rounded-2xl overflow-hidden min-h-[500px] flex flex-col",children:[m&&e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-20 text-center",children:[e.jsx(_,{className:"w-12 h-12 animate-spin text-[#C5A059] mb-4"}),e.jsx("p",{className:"text-[10px] uppercase tracking-[0.3em] font-bold text-gray-400",children:"Cargando pasarela segura..."})]}),o&&e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-20 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-50 text-red-500 rounded-full flex items-center justify-center mb-6",children:e.jsx(f,{className:"w-8 h-8"})}),e.jsx("p",{className:"text-sm font-serif mb-2",children:o}),e.jsx("button",{onClick:()=>window.location.reload(),className:"text-[10px] uppercase tracking-widest text-[#C5A059] font-bold underline",children:"Reintentar"})]}),!m&&!o&&e.jsxs("div",{className:"p-8 md:p-12 payFormTilopay space-y-8",children:[e.jsxs("h3",{className:"text-[10px] uppercase tracking-[0.3em] text-[#1A1A1A] font-bold mb-8 flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4 text-[#C5A059]"})," Método de Pago"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-8",children:[e.jsxs("button",{onClick:()=>c("card"),className:`p-4 border rounded-xl flex flex-col items-center gap-2 transition-all ${a==="card"?"border-[#C5A059] bg-[#C5A059]/5":"border-gray-100 grayscale hover:grayscale-0"}`,children:[e.jsx(b,{className:`w-5 h-5 ${a==="card"?"text-[#C5A059]":"text-gray-300"}`}),e.jsx("span",{className:"text-[8px] uppercase tracking-widest font-bold",children:"Tarjeta"})]}),e.jsxs("button",{onClick:()=>c("yappy"),className:`p-4 border rounded-xl flex flex-col items-center gap-2 transition-all ${a==="yappy"?"border-[#C5A059] bg-[#C5A059]/5":"border-gray-100 grayscale hover:grayscale-0"}`,children:[e.jsx(F,{className:`w-5 h-5 ${a==="yappy"?"text-[#C5A059]":"text-gray-300"}`}),e.jsx("span",{className:"text-[8px] uppercase tracking-widest font-bold",children:"Yappy"})]}),e.jsxs("button",{onClick:()=>c("sinpe"),className:`p-4 border rounded-xl flex flex-col items-center gap-2 transition-all ${a==="sinpe"?"border-[#C5A059] bg-[#C5A059]/5":"border-gray-100 grayscale hover:grayscale-0"}`,children:[e.jsx(f,{className:`w-5 h-5 ${a==="sinpe"?"text-[#C5A059]":"text-gray-300"}`}),e.jsx("span",{className:"text-[8px] uppercase tracking-widest font-bold",children:"SINPE"})]})]}),e.jsx("div",{className:a==="card"?"block animate-in fade-in slide-in-from-top-4":"hidden",children:e.jsx("div",{id:"tlpy_card_payment_div",className:"space-y-4"})}),e.jsx("div",{className:a==="yappy"?"block animate-in fade-in slide-in-from-top-4":"hidden",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-[10px] uppercase tracking-widest text-gray-400 font-bold",children:"Número de Teléfono Yappy"}),e.jsx("input",{id:"tlpy_phone_number",type:"text",value:d,onChange:s=>v(s.target.value),className:"w-full border-0 border-b border-gray-100 focus:border-[#C5A059] focus:ring-0 text-lg px-0 py-3 font-serif",placeholder:"6000-0000"}),e.jsx("div",{id:"tlpy_yappy_payment_div"})]})}),e.jsx("div",{className:a==="sinpe"?"block animate-in fade-in slide-in-from-top-4":"hidden",children:r?e.jsxs("div",{className:"bg-teal-50 p-6 rounded-2xl border border-teal-100 text-center",children:[e.jsx(D,{className:"w-10 h-10 text-teal-500 mx-auto mb-4"}),e.jsx("h4",{className:"font-serif text-lg text-teal-900 mb-2",children:"Instrucciones SINPE"}),e.jsx("p",{className:"text-sm text-teal-700 leading-relaxed",children:r.message}),e.jsxs("div",{className:"mt-4 p-4 bg-white rounded-xl font-mono text-lg font-bold text-teal-800",children:["#",r.number," ",e.jsx("br",{}),"Monto: ",r.currency," ",r.amount]})]}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase tracking-widest text-gray-400 font-bold mb-2",children:"Tipo DNI"}),e.jsxs("select",{value:y,onChange:s=>k(s.target.value),className:"w-full border-gray-100 rounded-lg text-sm focus:border-[#C5A059] focus:ring-[#C5A059]/20",children:[e.jsx("option",{value:"1",children:"Cédula Identidad"}),e.jsx("option",{value:"2",children:"Jurídica"}),e.jsx("option",{value:"6",children:"DIMEX"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase tracking-widest text-gray-400 font-bold mb-2",children:"DNI / Cédula"}),e.jsx("input",{type:"text",value:p,onChange:s=>w(s.target.value),className:"w-full border-gray-100 rounded-lg text-sm focus:border-[#C5A059] focus:ring-[#C5A059]/20",placeholder:"000000000"})]})]})})}),(!r||a!=="sinpe")&&e.jsx("button",{onClick:A,className:"w-full bg-[#1A1A1A] text-white py-5 rounded-xl font-sans uppercase tracking-[0.3em] text-[10px] font-bold hover:bg-[#C5A059] hover:shadow-xl hover:shadow-[#C5A059]/20 transition-all active:scale-[0.98]",children:a==="sinpe"?"Generar SINPE":`Pagar $${l} USD`}),e.jsx("div",{id:"responseTilopay",className:"mt-4"}),e.jsxs("div",{className:"flex items-center justify-center gap-6 pt-12 opacity-30 grayscale",children:[e.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Visa_Inc._logo.svg/2560px-Visa_Inc._logo.svg.png",className:"h-4 object-contain"}),e.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Mastercard-logo.svg/1280px-Mastercard-logo.svg.png",className:"h-6 object-contain"}),e.jsx("img",{src:"https://app.tilopay.com/assets/img/logo-tilopay-white.png",className:"h-5 object-contain invert"})]})]})]})})]})})]})}export{V as default};
